<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">Listing Patrons</h1>
  </div>
</div>

<% if @patron.errors.any? then %>
  <ul class="list-unstyled">
    <% @patron.errors.full_messages.each do |message| %>
      <li class="alert alert-danger"><%= message %></li>
    <% end %>
  </ul>
<% end %>

<div class="panel panel-default">
  <div class="panel-heading">
    <div class="dt-buttons btn-group">
      <a class="btn btn-default" data-toggle="modal" data-target="#newModal">
        <span>New</span>
      </a>
      <a class="btn btn-default" data-toggle="modal" data-target="#editModal">
        <span>Edit</span>
      </a>
      <a class="btn btn-default" data-toggle="modal" data-target="#deleteModal">
        <span>Delete</span>
      </a>
    </div>
    <a class="btn btn-default" data-toggle="modal" data-target="#showModal">
      <span>Show</span>
    </a>
  </div>
  <div class="panel-body">
    <div class="dataTable_wrapper">
      <table class="table table-striped table-bordered table-hover dataTable" id="patrons">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Address</th>
            <th>Phone Number</th>
          </tr>
        </thead>
        <tbody>
          <% @patrons.each do |patron| %>
            <tr>  
              <td><%= patron.id %></td>
              <td><%= patron.first_name + " " + patron.last_name %></td>
              <td><%= patron.street_address %>
                <br><%= "#{patron.city}, #{patron.state.upcase} #{patron.zip}" %>
              </td>
              <td><%= patron.phone_number %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- New Patron Modal -->
<div class="fade modal" id="newModal" tabindex="-1" role="dialog" aria-labelledby="newModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 class="modal-title" id="newModalLabel">New Patron</h4>
      </div>
      <div class="modal-body">
        <%= render 'form' %>
      </div>
    </div>
  </div>
</div>

<% if @current_patron then %>
  <!-- Edit Patron Modal -->
  <div class="fade modal" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h4 class="modal-title" id="editModalLabel">Edit Patron</h4>
          </div>
          <div class="modal-body">
            <%= render 'form' %>
          </div>
      </div>
    </div>
  </div>

  <!-- Delete Patron Modal -->
  <div class="fade modal" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
            <h4 class="modal-title" id="deleteModalLabel">Delete Patron</h4>
          </div>
          <div class="modal-body">
            Are you sure you want to delete this patron?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="deleteModalConfirm">Confirm</button>
          </div>
      </div>
    </div>
  </div>

  <!-- Show Patron Modal -->
  <div class="fade modal" id="showModal" tabindex="-1" role="dialog" aria-labelledby="showModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
            <h4 class="modal-title" id="showModalLabel"><%= @current_patron.name %></h4>
          </div>
          <div class="modal-body">
            <%= @current_patron.id %>
            <%= @current_patron.street_address %>
            <%= "#{@current_patron.city} #{@current_patron.state.upcase} #{@current_patron.zip}" %>
            <%= @current_patron.phone_number %>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
          </div>
      </div>
    </div>
  </div>
<% end %>
