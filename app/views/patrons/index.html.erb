<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">Patrons <a class="btn btn-default" data-toggle="modal" data-target="#newModal">
        <span>+</span>
      </a>
    </h1>
  </div>
</div>

<% if flash[:notice] then %>
  <div class="alert alert-info"><%= flash[:notice] %></div>
<% end %>
<% if flash[:alert] then %>
  <div class="alert alert-danger"><%= flash[:alert] %></div>
<% end %>

<% if @patron.errors.any? then %>
  <ul class="list-unstyled">
    <% @patron.errors.full_messages.each do |message| %>
      <li class="alert alert-danger"><%= message %></li>
    <% end %>
  </ul>
<% end %>

<div class="panel panel-default">
  <div class="panel-body">
    <div class="dataTable_wrapper">
      <table class="table table-striped table-bordered table-hover" id="patrons" style="width: 100%;">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Address</th>
            <th>Phone Number</th>
          </tr>
        </thead>
        <tbody>
          <% @patrons.each do |patron| %>
            <tr>  
              <td><%= patron.id %></td>
              <td>
                <%= patron.name %>
                <%= delete_link(patron, "patron") %>
                <%= link_to edit_patron_path(patron), data: {remote: true, toggle: 'modal', target: '#editModal'}, class: 'tooltip-edit' do %>
                  <div class="fa fa-wrench" data-toggle='tooltip' data-placement='top' data-original-title='Edit'></div>
                <% end %>
              </td>
              <td><%= patron.street_address.titlecase %>, 
                  <%= patron.city.titlecase %>, 
                  <%= patron.state.upcase %> 
                  <%= patron.zip %>
              </td>
              <td><%= patron.phone_number %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- New Patron Modal -->
<div class="fade modal" id="newModal" tabindex="-1" role="dialog" aria-labelledby="newModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
        <h4 class="modal-title" id="newModalLabel">New Patron</h4>
      </div>
      <div class="modal-body">
        <%= render 'form' %>
      </div>
    </div>
  </div>
</div>

<!-- Edit Patron Modal -->
<div class="fade modal" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true" style="display: none;">
</div>

<% if @current_patron then %>
  <!-- Show Patron Modal -->
  <div class="fade modal" id="showModal" tabindex="-1" role="dialog" aria-labelledby="showModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
            <h4 class="modal-title" id="showModalLabel"><%= @current_patron.name %></h4>
          </div>
          <div class="modal-body">
            <%= @current_patron.id %>
            <%= @current_patron.street_address %>
            <%= "#{@current_patron.city} #{@current_patron.state.upcase} #{@current_patron.zip}" %>
            <%= @current_patron.phone_number %>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
          </div>
      </div>
    </div>
  </div>
<% end %>
